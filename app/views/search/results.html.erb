<%= content_for(:title, results_page_title(@enhanced_query)) %>

<% content_for :additional_meta_tag do %>
  <meta name="robots" content="noindex, nofollow" />
<% end %>

<div id="content-wrapper" class="space-wrap">
  <%= render(partial: 'shared/error', collection: @errors) %>

  <%= render(partial: 'trigger_tacos') if tacos_enabled? %>

  <%= turbo_frame_tag "search-results", data: { turbo_action: "advance" } do %>
    <div id="results-section">
      
      <% if @show_primo_continuation %>

        <%= render partial: 'search/primo_continuation' %>

      <% elsif @results.present? && @errors.blank? %>

        <h2 class="results-context"><%= results_summary(@pagination[:hits]) %></h2>
        <p class="results-context-description">From all MIT Libraries sources</p>    
        <div id="results-layout-wrapper">  
          <main id="results">
            <ol class="results-list" start="<%= @pagination[:start] %>">             
              <% @results.each do |result| %>
                  <% if result[:api] == 'primo' %>
                    <%= render(partial: 'search/result_primo', locals: { result: result }) %>
                  <% elsif result[:api] == 'timdex' %>
                    <%= render(partial: 'search/result', locals: { result: result }) %>
                  <% end %>
                <% end %>
            </ol>
            <%= render partial: "results_callouts" %>
          </main>
          <%= render partial: "results_sidebar" %>
        </div>
        <%= render partial: "pagination" %>

      <% elsif @errors.blank? %>

        <div id="results-layout-wrapper">
          <main id="results">
            <div class="no-results">
              <p class="hd-2">No results found for your search</p>
            </div>
          </main>
        </div>

      <% end %>

    </div>

  <% end %>

</div>

<%= javascript_include_tag "filters" %>
